<!DOCTYPE html>
<html>  
<head>
	<%= render partial: "layouts/header" %>
	
</head>
<body>

<%= render partial: "layouts/slidebar" %>

<style>

a:link, a:visited, a:hover, a:active {
    color: #3498db;
    
    }


.ui-helper-hidden-accessible { display:none; }
ul.ui-autocomplete {
    list-style: none;
}

.ui-autocomplete { height: 200px; overflow-y: scroll; overflow-x: auto; }

.ui-menu .ui-menu-item .ui-menu-item-icon {
    background-repeat: no-repeat;
    background-position: 2px, 0;
    background-size: 16px;
    padding-left: 23px;
}

.ui-autocomplete li {
        
        background-color: white;
        display:block;
        width:300px;
        height:50px;
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
        border-bottom: 1px solid rgba(82,168,236,.8);
        /*font-size:medium;
        border: 1px solid rgba(82,168,236,.8);
        border-top-right-radius:.25em;
        border-top-left-radius:.25em;
        border-bottom-right-radius:.25em;
        border-bottom-left-radius:.25em;
        z-index: 9000;*/
    }
    .ui-autocomplete li a {
        color: black;
        margin-left: 10px;
    }

    .ui-autocomplete li a:hover {
        color: black;
        background-color:#3498DB; 
    }
    .ui-autocomplete li:hover { 
        background-color:#3498DB; 
    }

    .ui-autocomplete {
        height: 200px;
        overflow-y: auto;
        overflow-x: auto;
    }


</style>

<!-- MAIN WRAPPER -->
<div class="body-wrap">


     <% 
        if !flash[:notice].blank? 
        
    %>

        <div class="alert alert-info fade in" style="text-align:center">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">Ã—</button>
            <%= flash[:notice] %>
        </div>

      <% end %>
    <%= yield %>
     
    <!-- FOOTER -->
    <footer class="footer">
        <%= render partial: "layouts/footer" %>
    </footer>
</div>

<!-- Essentials -->



<script src="<%= CLOUDFRONT_HOST %>/js/modernizr.custom.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/bootstrap/js/bootstrap.min.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/js/jquery.mousewheel-3.0.6.pack.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/js/jquery.easing.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/js/jquery.metadata.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/js/jquery.hoverup.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/js/jquery.hoverdir.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/js/jquery.stellar.js"></script>


<!-- Boomerang mobile nav - Optional  -->
<script src="<%= CLOUDFRONT_HOST %>/assets/responsive-mobile-nav/js/jquery.dlmenu.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/responsive-mobile-nav/js/jquery.dlmenu.autofill.js"></script>

<!-- Forms -->
<script src="<%= CLOUDFRONT_HOST %>/assets/ui-kit/js/jquery.powerful-placeholder.min.js"></script> 
<script src="<%= CLOUDFRONT_HOST %>/assets/ui-kit/js/cusel.min.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/sky-forms/js/jquery.form.min.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/sky-forms/js/jquery.validate.min.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/sky-forms/js/jquery.maskedinput.min.js"></script>
<!-- <script src="<%= CLOUDFRONT_HOST %>/assets/sky-forms/js/jquery.modal.js"></script> -->

<!-- Assets -->
<script src="<%= CLOUDFRONT_HOST %>/assets/hover-dropdown/bootstrap-hover-dropdown.min.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/page-scroller/jquery.ui.totop.min.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/mixitup/jquery.mixitup.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/mixitup/jquery.mixitup.init.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/waypoints/waypoints.min.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/milestone-counter/jquery.countTo.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/easy-pie-chart/js/jquery.easypiechart.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/social-buttons/js/rrssb.min.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/nouislider/js/jquery.nouislider.min.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/owl-carousel/owl.carousel.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/bootstrap/js/tooltip.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/bootstrap/js/popover.js"></script>

<!-- Sripts for individual pages, depending on what plug-ins are used -->
<script src="<%= CLOUDFRONT_HOST %>/assets/layerslider/js/greensock.js" type="text/javascript"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/layerslider/js/layerslider.transitions.js" type="text/javascript"></script>
<script src="<%= CLOUDFRONT_HOST %>/assets/layerslider/js/layerslider.kreaturamedia.jquery.js" type="text/javascript"></script>
<!-- Initializing the slider -->
<script>
    jQuery("#layerslider").layerSlider({
        pauseOnHover: true,
        autoPlayVideos: false,
        skinsPath: 'assets/layerslider/skins/',
        responsive: false,
        responsiveUnder: 1280,
        layersContainer: 1280,
        skin: 'borderlessdark3d',
        hoverPrevNext: true,
    });

$('#TermsLink').click(function () {
        //Load the Login action which will return 
        // the partial view _Login

        console.log('terms link clicked');

        $dialog = $('<div></div>')
                   .html('<iframe style="border: 1px solid;border-color: #e0eded;background:white;" src="/termsconditions/index_no_layout" width="100%" height="100%"></iframe>')
                   .dialog({
                       autoOpen: false,
                       modal: true,
                       height: $(window).height()/2,
                       width: $(window).width()/2,
                       title: "Changefindr - Donate Unused Gift Card Balance",
                       position: { my: "center", at: '150', of: $(window) },


                       buttons: {
                           
                           "Close": {
                               text: 'Close',
                               
                               click: function () {

                                   // close dialog and pop up a message to donate
                                   $(this).dialog("destroy");
                               }
                           }

                       }
                   });

        $dialog.dialog('open');
        
    });


  $("#searchcausemain").autocomplete({


        source: function (request, response) {
            $.ajax({
                url: '/cause/causeautocomplete', type: "POST", dataType: "json",
                data: { searchText: request.term, maxResults: 10 },
                success: function (data) {

                    console.log('success: ', data)

                    // data is an array of objects and must be transformed for autocomplete to use
                    var array = data.error ? [] : $.map(data, function (m) {
                        return {
                            id: m.charityid,
                            name: m.charityname,
                            logo: m.brandLogoImage
                            
                        };
                    });
                    response(array);


                },
                failure: function (data) {
                    console.log('autcomplete failed');
                }
            })
        },
        minLength: 1,
        select: function (event, ui) {
            //console.log('comes in selected item');
            event.preventDefault();
            window.location.href = "/cause/show/" + ui.item.id;
 
        }
    })
    .data("ui-autocomplete")._renderItem = function (ul, item) {

        console.log("rendering item logo= ", item.logo);

        return $('<li class="ui-menu-item-with-icon" style="margin-top:10px"></li>')
            .data("item.ui-autocomplete", item.charityname)
            .append('<a><img src="' + item.logo + '"height="45px" width="75px">&nbsp;&nbsp;&nbsp;' + item.name + '</a>')
            .appendTo(ul);
    };

try {
    $("#searchmerchant").autocomplete({

            source: function (request, response) {
                $.ajax({
                    url: '/merchant/merchantautocomplete', type: "POST", dataType: "json",
                    data: { searchText: request.term, maxResults: 10 },
                    success: function (data) {

                        console.log('success: ', data)

                        // data is an array of objects and must be transformed for autocomplete to use
                        var array = data.error ? [] : $.map(data, function (m) {
                            return {
                                id: m.merchantid,
                                name: m.merchantname,
                                logo: m.logo
                                
                            };
                        });
                        response(array);


                    },
                    failure: function (data) {
                        console.log('autcomplete failed');
                    }
                })
            },
            minLength: 1,
            select: function (event, ui) {
                //console.log('comes in selected item');
                event.preventDefault();
                if (ui.item.id != 85)
                {
                    window.location.href = "/giftcard/new/" + ui.item.id;
                } else
                {
                 window.location.href = "/donate/new?merchantid=" + ui.item.id;   
                }
     
            }
        })
        .data("ui-autocomplete")._renderItem = function (ul, item) {


                logourl = item.logo

                if (logourl == null || logourl == '')
                {
                    logourl = '<%= CLOUDFRONT_HOST %>/images/giftcard-3.jpg'
                }


            //console.log("logo= ", item.logo);

            return $('<li class="ui-menu-item-with-icon"></li>')
                .data("item.ui-autocomplete", item.merchantname)
                .append('<a><img src="' + logourl + '"height="45px" width="75px">&nbsp;&nbsp;&nbsp;' + item.name + '</a>')
                .appendTo(ul);
        };
} catch (Exception) {}





</script>

<!-- Boomerang App JS -->
<script src="<%= CLOUDFRONT_HOST %>/js/wp.app.js"></script>
<!--[if lt IE 9]>
    <script src="<%= CLOUDFRONT_HOST %>/js/html5shiv.js"></script>
    <script src="<%= CLOUDFRONT_HOST %>/js/respond.min.js"></script>
<![endif]-->

<!-- Temp -- You can remove this once you started to work on your project -->
<script src="<%= CLOUDFRONT_HOST %>/js/jquery.cookie.js"></script>
<script src="<%= CLOUDFRONT_HOST %>/js/wp.switcher.js"></script>
<script type="text/javascript" src="<%= CLOUDFRONT_HOST %>/js/wp.ga.js"></script>



</body>
</html> 